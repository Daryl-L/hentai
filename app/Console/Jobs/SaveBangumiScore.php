<?php

namespace App\Console\Jobs;

use App\Http\Repositories\PinRepository;
use App\Http\Repositories\Repository;
use App\Http\Repositories\UserRepository;
use App\Models\Bangumi;
use App\Models\Idol;
use App\Models\Pin;
use App\Models\Tag;
use App\Services\OpenSearch\Search;
use App\Services\Qiniu\Qshell;
use App\Services\Spider\BangumiSource;
use App\Services\Spider\Query;
use App\User;
use Illuminate\Console\Command;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Redis;

class SaveBangumiScore extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'SaveBangumiScore';
    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'save bangumi score';
    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {
        $source = [
            '8.94 - 2004 - 攻壳机动队',
            '8.93 - 1998 - 星际牛仔',
            '8.90 - 2008 - CLANNAD',
            '8.88 - 2011 - 命运石之门',
            '8.88 - 1988 - 银河英雄传说',
            '8.81 - 2010 - 凉宫春日',
            '8.80 - 2008 - 水星领航员',
            '8.77 - 2009 - 钢之炼金术师',
            '8.75 - 1999 - 浪客剑心',
            '8.74 - 2009 - 新世纪福音战士',
            '8.73 - 2006 - 反叛的鲁路修',
            '8.69 - 1986 - 天空之城',
            '8.63 - 2005 - 虫师',
            '8.62 - 2003 - 百变之星',
            '8.61 - 1997 - 幽灵公主',
            '8.61 - 2011 - 银魂',
            '8.61 - 2007 - 天元突破',
            '8.60 - 2003 - 星空清理者',
            '8.58 - 2014 - 白箱',
            '8.56 - 1984 - 风之谷',
            '8.56 - 2001 - 千与千寻',
            '8.54 - 2006 - 死亡笔记',
            '8.53 - 2004 - 怪物',
            '8.52 - 2011 - 魔法少女小圆',
            '8.51 - 2007 - 永生之酒',
            '8.49 - 2017 - 3月的狮子',
            '8.47 - 2007 - 空之境界',
            '8.47 - 2017 - 昭和元禄落语心中',
            '8.46 - 2006 - 蜂蜜与四叶草',
            '8.46 - 2013 - 歌牌情缘',
            '8.45 - 2017 - 来自深渊',
            '8.44 - 2004 - 混沌武士',
            '8.44 - 2015 - 少女与战车',
            '8.43 - 2002 - 十二国记',
            '8.42 - 1993 - 灌篮高手',
            '8.42 - 2009 - 夏目友人帐',
            '8.40 - 2016 - 你的名字',
            '8.39 - 2011 - 白兔糖',
            '8.39 - 2016 - 排球少年',
            '8.38 - 2003 - 全金属狂潮',
            '8.38 - 2008 - 悠久之翼',
            '8.38 - 2006 - 圣母在上',
            '8.37 - 2008 - 夏娃的时间',
            '8.37 - 2007 - 电脑线圈',
            '8.37 - 1999 - 猎人',
            '8.37 - 2008 - 龙与虎',
            '8.37 - 2006 - 黑礁',
            '8.36 - 2007 - 精灵守护者',
            '8.36 - 1995 - 罗密欧的蓝天',
            '8.35 - 2012 - 食梦者',
            '8.35 - 2006 - 皇家国教骑士团',
            '8.35 - 2011 - Fate',
            '8.34 - 2014 - 乒乓',
            '8.34 - 2001 - 棋魂',
            '8.33 - 1984 - 超时空要塞',
            '8.32 - 2010 - 机动战士高达',
            '8.32 - 2009 - 夏日大作战',
            '8.32 - 2007 - 交响情人梦',
            '8.31 - 2002 - 千年女优',
            '8.30 - 2006 - Kanon',
            '8.30 - 2018 - 比宇宙更远的地方',
            '8.30 - 2009 - 物语',
            '8.29 - 1993 - 机动警察',
            '8.29 - 1998 - 蓝色恐惧',
            '8.28 - 1988 - 龙猫',
            '8.27 - 2011 - 未闻花名',
            '8.27 - 2006 - 穿越时空的少女',
            '8.26 - 2016 - 吹响！悠风号',
            '8.25 - 2003 - 东京教父',
            '8.25 - 1988 - 飞跃巅峰',
            '8.25 - 2007 - 秒速5厘米',
            '8.25 - 2005 - 交响诗篇',
            '8.24 - 1979 - 鲁邦三世',
            '8.24 - 2000 - 第一神拳',
            '8.24 - 1999 - 麻辣教师GTO',
            '8.22 - 1995 - 侧耳倾听',
            '8.22 - 2006 - 欢迎加入NHK',
            '8.22 - 1986 - 相聚一刻',
            '8.21 - 2006 - 盗梦侦探',
            '8.20 - 2003 - 奇诺之旅',
            '8.20 - 2002 - 萩萩公主',
            '8.20 - 2012 - 狼的孩子雨和雪',
            '8.20 - 2010 - 四叠半神话大系',
            '8.19 - 2007 - 黑之契约者',
            '8.19 - 2012 - 宇宙战舰大和号',
            '8.18 - 2007 - 寒蝉鸣泣之时',
            '8.18 - 2003 - 铳墓',
            '8.18 - 1999 - 星界',
            '8.16 - 2007 - 王牌投手 振臂高挥',
            '8.16 - 2008 - 狼与香辛料',
            '8.16 - 2008 - 海马',
            '8.16 - 2007 - 怪化猫',
            '8.15 - 2012 - 宇宙兄弟',
            '8.15 - 2016 - JOJO的奇妙冒险',
            '8.14 - 1998 - 魔卡少女樱',
            '8.13 - 1979 - 凡尔赛玫瑰',
            '8.13 - 1996 - 秀逗魔导士',
            '8.13 - 2002 - 花田少年史',
            '8.13 - 1989 - 魔女宅急便',
            '8.13 - 2014 - 四月是你的谎言',
            '8.13 - 2008 - 回忆积木小屋',
            '8.12 - 2009 - 四叶游戏',
            '8.11 - 1992 - 红猪',
            '8.11 - 2016 - 在这世界的角落',
            '8.10 - 2012 - 坂道上的阿波罗',
            '8.10 - 1988 - 萤火虫之墓',
            '8.10 - 1997 - 剑风传奇',
            '8.10 - 2007 - 异邦人 无皇刃谭',
            '8.09 - 2009 - 东之伊甸',
            '8.09 - 2002 - 阿滋漫画大王',
            '8.09 - 2016 - 声之形',
            '8.09 - 2009 - 好想告诉你',
            '8.09 - 2004 - 岩窟王',
            '8.09 - 2009 - 兽之奏者艾琳',
            '8.09 - 2008 - 四月一日灵异事件簿',
            '8.09 - 2008 - 超智游戏',
            '8.09 - 2010 - 刀语',
            '8.08 - 2013 - 进击的巨人',
            '8.08 - 2005 - 魔法少女奈叶',
            '8.08 - 2017 - 游戏人生',
            '8.08 - 2006 - 樱兰高校男公关部',
            '8.08 - 2007 - 赌博默示录',
            '8.08 - 2005 - 勇者王GaoGaiGar',
            '8.08 - 1980 - 明日之丈',
            '8.07 - 1978 - 未来少年柯南',
            '8.07 - 1984 - 福星小子',
            '8.07 - 2015 - 一拳超人',
            '8.07 - 2011 - 虎与兔',
            '8.06 - 2016 - 只有我不存在的城市',
            '8.06 - 1995 - 回忆三部曲',
            '8.06 - 2013 - 辉夜姬物语',
            '8.06 - 2004 - 棒球大联盟',
            '8.06 - 1985 - 棒球英豪',
            '8.05 - 2004 - 校园迷糊大王',
            '8.05 - 2011 - 日常',
            '8.04 - 2008 - 下一站巨星',
            '8.04 - 2008 - 食灵零',
            '8.04 - 2005 - AIR',
            '8.04 - 2006 - 娜娜',
            '8.03 - 2002 - 灰羽联盟',
            '8.03 - 2017 - 宝石之国',
            '8.03 - 1992 - 幽游白书',
            '8.03 - 2014 - 月刊少女野崎君',
            '8.03 - 2004 - 小魔女DoReMi',
            '8.03 - 2012 - 来自新世界',
            '8.02 - 2003 - 读或死',
            '8.02 - 2007 - 幸运星',
            '8.02 - 2001 - 水果篮子',
            '8.01 - 2004 - 摇滚新乐团',
            '8.01 - 2012 - 冰菓',
            '8.01 - 2000 - FLCL',
            '8.01 - 1999 - 无限的未知',
            '8.00 - 2013 - 向阳素描',
            '8.00 - 2013 - 言叶之庭',
            '8.00 - 1979 - 银河铁道999',
            '7.99 - 2010 - 红线',
            '7.99 - 2011 - 轻音少女',
            '7.99 - 2017 - 有顶天家族',
            '7.99 - 2015 - 悠哉日常大王',
            '7.99 - 2017 - 我的英雄学院',
            '7.99 - 1997 - 少女革.命',
            '7.99 - 2010 - 无头骑士异闻录',
            '7.99 - 2007 - 草莓棉花糖',
            '7.98 - 1988 - 橙路',
            '7.98 - 2010 - 光之美少女',
            '7.98 - 2002 - 名侦探柯南',
            '7.97 - 2013 - 斩服少女',
            '7.97 - 2003 - 最终流放',
            '7.97 - 2005 - 斗牌传说',
            '7.96 - 1998 - 危险调查员',
            '7.96 - 1988 - 阿基拉',
            '7.96 - 1999 - 数码兽大冒险',
            '7.96 - 2012 - 心理测量者',
            '7.96 - 2011 - 花开伊吕波',
            '7.95 - 2015 - 希德尼娅的骑士',
            '7.95 - 1996 - 机动战舰',
            '7.95 - 1999 - 海贼王',
            '7.95 - 2018 - 朝花夕誓',
            '7.95 - 2007 - 奔向地球',
            '7.95 - 1990 - 蓝宝石之谜',
            '7.94 - 2011 - 迷糊餐厅',
            '7.94 - 2000 - 人狼',
            '7.94 - 2008 - 重金属摇滚双面人',
            '7.93 - 1998 - 他和她的故事',
            '7.93 - 2004 - 心灵游戏',
            '7.93 - 2002 - 蜡笔小新',
            '7.93 - 2002 - 热带雨林的爆笑生活',
            '7.93 - 2013 - 银之匙',
            '7.93 - 2004 - 妖精的旋律',
            '7.93 - 2014 - 元气囝仔',
            '7.93 - 2007 - 南家三姐妹',
            '7.93 - 2003 - 神枪少女',
            '7.92 - 2014 - 寄生兽',
            '7.92 - 2003 - 黑客帝国动画版',
            '7.92 - 2017 - 月色真美',
            '7.91 - 2001 - 吸血鬼猎人D',
            '7.91 - 2002 - 圣斗士星矢',
            '7.91 - 2017 - 春宵苦短，少女前进吧！',
            '7.91 - 2009 - 电波系彼女',
            '7.91 - 2007 - 翼·年代记',
            '7.90 - 2007 - 大剑',
            '7.90 - 2015 - 玉响',
            '7.89 - 2016 - 灵能百分百',
            '7.89 - 2008 - 天体战士',
            '7.89 - 2008 - 再见绝望先生',
            '7.89 - 2007 - 现视研',
            '7.89 - 2005 - 苍穹之法芙娜',
            '7.88 - 2007 - 濑户的花嫁',
            '7.88 - 2010 - 搞笑漫画日和',
            '7.88 - 1993 - 怪医黑杰克',
            '7.88 - 2017 - 小魔女学园',
            '7.87 - 2010 - 少年犯之七人',
            '7.87 - 2005 - 玻璃假面',
            '7.87 - 2010 - 海月姬',
            '7.86 - 2011 - 回转企鹅罐',
            '7.86 - 2013 - 起风了',
            '7.85 - 1982 - 传说巨神伊迪安',
            '7.85 - 2007 - 竹刀少女',
            '7.85 - 2017 - 少女终末旅行',
            '7.85 - 2013 - 来自风平浪静的明天',
            '7.84 - 2006 - 传颂之物',
            '7.84 - 2007 - 英国恋物语艾玛',
            '7.84 - 1992 - 大铁人',
            '7.84 - 2009 - 犬夜叉',
            '7.83 - 2008 - 真实之泪',
            '7.83 - 2012 - 男子高中生的日常',
            '7.83 - 1987 - 王立宇宙军 欧尼亚米斯之翼',
            '7.83 - 2009 - 铁腕巴迪',
            '7.82 - 1983 - 装甲骑兵VOTOMS',
            '7.82 - 2018 - 摇曳露营',
            '7.82 - 1997 - 佛兰德斯的狗',
            '7.81 - 2004 - 哈尔的移动城堡',
            '7.81 - 2005 - 不可思议的教室',
            '7.81 - 2005 - 最终幻想',
            '7.81 - 2018 - 高分少女',
            '7.81 - 2004 - 妄想代理人',
            '7.81 - 1996 - 乌龙派出所',
            '7.80 - 2018 - 佐贺偶像是传奇',
            '7.80 - 2013 - 记录的地平线',
            '7.80 - 2004 - 云之彼端，约定的地方',
            '7.80 - 2008 - 噬魂师',
            '7.79 - 1977 - 咪咪流浪记',
            '7.79 - 2011 - 萤火之森',
            '7.79 - 2006 - ZEGAPAIN',
            '7.79 - 2014 - 日本动画人博览会',
            '7.79 - 2004 - 奇幻旅程',
            '7.79 - 1991 - 青兰圆舞曲',
            '7.79 - 2004 - 头文字D',
            '7.79 - 2007 - 恋爱情结',
            '7.79 - 1998 - 枪神',
            '7.79 - 2014 - 玉子市场',
            '7.79 - 2006 - 监狱兔',
            '7.79 - 2011 - 偶像大师',
            '7.78 - 2007 - 天才嘉年华',
            '7.78 - 2016 - Re：从零开始的异世界生活',
            '7.78 - 2017 - 为美好的世界献上祝福',
            '7.77 - 2015 - 我的青春恋爱物语果然有问题',
            '7.77 - 2018 - 紫罗兰永恒花园',
            '7.77 - 2012 - 人类衰退之后',
            '7.77 - 1995 - On Your Mark',
            '7.77 - 1987 - 城市猎人',
            '7.77 - 1986 - 龙珠',
            '7.77 - 2015 - 心灵想要大声呼喊',
            '7.76 - 1979 - 哆啦A梦',
            '7.76 - 2005 - 甲贺忍法帖',
            '7.76 - 2012 - TARI TARI',
            '7.76 - 2014 - 回忆中的玛妮',
            '7.75 - 2006 - 地狱少女',
            '7.75 - 1999 - 此时此刻的我',
            '7.75 - 1997 - 金田一少年事件簿',
            '7.75 - 2003 - 宇宙星路',
            '7.75 - 2018 - 黑社会的超能力女儿',
            '7.74 - 2009 - 甜甜私房猫',
            '7.74 - 2004 - 舞-HiME',
            '7.74 - 2005 - 神是中学生',
            '7.74 - 1998 - 高智能方程式',
            '7.73 - 2018 - 恶魔人 crybaby',
            '7.73 - 2007 - NHK15个动画短片',
            '7.73 - 1996 - 玩偶游戏',
            '7.73 - 2018 - 终将成为你',
            '7.72 - 2016 - 星之梦',
            '7.72 - 2010 - 江户盗贼团五叶',
            '7.72 - 2003 - 狼雨',
            '7.72 - 2011 - 灵异E接触',
            '7.72 - 2002 - 猫的报恩',
            '7.72 - 2012 - 军火女王',
            '7.72 - 2010 - Angel Beats!',
            '7.72 - 2003 - 废弃公主',
            '7.72 - 2015 - 钻石王牌',
            '7.71 - 2010 - 来来猫',
            '7.71 - 2009 - 科学超电磁炮',
            '7.71 - 2007 - 萌菌物语',
            '7.71 - 2016 - 食戟之灵',
            '7.70 - 2010 - 你看起来很好吃',
            '7.70 - 2010 - 荒川爆笑团',
            '7.70 - 1995 - 黄金宝贝',
            '7.70 - 1998 - 玲音',
            '7.70 - 2018 - ReLIFE',
            '7.70 - 2011 - GOSICK',
            '7.70 - 2017 - Princess Principal',
            '7.70 - 2011 - 超元气三姐妹',
            '7.70 - 2014 - 太空丹迪',
            '7.69 - 2010 - 女仆咖啡厅',
            '7.69 - 2010 - 壳中少女',
            '7.69 - 2007 - 素描本',
            '7.69 - 2018 - 青春期笨蛋不做兔女郎学姐的梦',
            '7.69 - 2007 - 旋风管家',
            '7.68 - 2018 - 来玩游戏吧',
            '7.67 - 2016 - 暗杀教室',
            '7.67 - 2005 - 曙光少女',
            '7.67 - 2012 - 少年同盟',
            '7.66 - 2018 - 齐木楠雄的灾难',
            '7.66 - 2017 - NEW GAME',
            '7.66 - 2010 - 吊带袜天使',
            '7.66 - 2002 - 翼神传说',
            '7.66 - 2014 - 乐园追放',
            '7.65 - 2016 - 冰上的尤里',
            '7.65 - 2015 - 监狱学园',
            '7.65 - 2007 - 彩云国物语',
            '7.65 - 2006 - 史上最强弟子兼一',
            '7.65 - 2008 - 亡念之扎姆德',
            '7.65 - 2005 - 到另一个你的身边去',
            '7.65 - 1992 - 间之楔',
            '7.65 - 2017 - 幼女战记',
            '7.65 - 2016 - 飞翔的魔女',
            '7.65 - 2017 - 小林家的龙女仆',
            '7.64 - 2013 - 打工吧！魔王大人',
            '7.64 - 1996 - 美少女战士',
            '7.64 - 2004 - 风人物语',
            '7.64 - 2015 - 怪物之子',
            '7.63 - 2010 - 侵略！乌贼娘',
            '7.63 - 1992 - 天地无用',
            '7.63 - 2013 - 白色相簿',
            '7.63 - 2007 - 冬之蝉',
            '7.62 - 1992 - 宇宙骑士',
            '7.62 - 2016 - 同级生',
            '7.62 - 2009 - 天才麻将少女',
            '7.62 - 2002 - 喜剧',
            '7.62 - 2016 - 编舟记',
            '7.62 - 2007 - 罗密欧与朱丽叶',
            '7.61 - 2012 - 中二病也要谈恋爱',
            '7.61 - 2001 - 猫汤',
            '7.61 - 2010 - 妄想学生会',
            '7.61 - 2010 - 借东西的小人阿丽埃蒂',
            '7.61 - 2018 - 黄金神威',
            '7.61 - 2017 - 兽娘动物园',
            '7.61 - 1994 - 逮捕令',
            '7.61 - 2018 - 少女歌剧 Revue Starlight',
            '7.60 - 2001 - 代号17',
            '7.60 - 2008 - 卡辛',
            '7.60 - 2007 - 地球防卫少年',
            '7.60 - 2018 - Megalo Box',
            '7.60 - 2009 - 小鸠',
            '7.60 - 2012 - Another',
            '7.60 - 2011 - 笨蛋，测验，召唤兽',
            '7.60 - 2004 - 七武士',
            '7.59 - 2006 - 双面骑士',
            '7.59 - 1999 - 盖塔机器人',
            '7.59 - 2007 - 剑豪生死斗',
            '7.59 - 2012 - 强袭魔女',
            '7.59 - 2009 - 魔法老师',
            '7.59 - 2002 - 银河天使',
            '7.58 - 2005 - 蔷薇少女',
            '7.58 - 2016 - 灰与幻想的格林姆迦尔',
            '7.58 - 2012 - 摇曳百合',
            '7.58 - 2007 - 铁马少年',
            '7.58 - 2013 - 翠星之加尔刚蒂亚',
            '7.57 - 1983 - 赤足小子',
            '7.57 - 1996 - 贤治之春',
            '7.57 - 2010 - 欢迎来到宇宙SHOW',
            '7.57 - 1974 - 阿尔卑斯山的少女',
            '7.57 - 2006 - 仰望半月的夜空',
            '7.57 - 2003 - 星球流浪记',
            '7.57 - 1982 - 哥普拉',
            '7.57 - 2018 - 妖精森林的小不点',
            '7.57 - 1989 - 乱马1/2',
            '7.57 - 2008 - 纯情罗曼史',
            '7.57 - 1990 - 罗德斯岛战记',
            '7.57 - 2008 - 死后文',
            '7.57 - 1996 - 天空之艾斯嘉科尼',
            '7.57 - 2007 - sola',
            '7.57 - 2011 - 世界第一初恋',
            '7.56 - 2007 - 月光旅程',
            '7.56 - 2002 - 寻找满月',
            '7.56 - 2017 - 血界战线',
            '7.56 - 2009 - 幻灵镇魂曲',
            '7.56 - 2012 - 邻座的怪同学',
            '7.56 - 2015 - 网球优等生',
            '7.55 - 2006 - 死亡代理人',
            '7.55 - 2010 - 破刃之剑',
            '7.55 - 2009 - 东京地震8.0',
            '7.55 - 2002 - 星之声',
            '7.55 - 2006 - 我的女神',
            '7.55 - 2001 - 分身战士',
            '7.54 - 2008 - 苍色骑士',
            '7.54 - 2009 - 宵星传说',
            '7.54 - 1993 - 听到涛声',
            '7.54 - 2016 - 漂流武士',
            '7.54 - 2003 - 高桥留美子剧场',
            '7.53 - 2015 - 请问您今天要来点兔子吗',
            '7.53 - 2003 - 你所期望的永远',
            '7.53 - 2017 - 魔法使的新娘',
            '7.53 - 2015 - 火影忍者',
            '7.53 - 2018 - 向山进发',
            '7.53 - 2013 - 王者天下',
            '7.53 - 2006 - 苍之茧',
            '7.53 - 2004 - KERORO军曹',
            '7.53 - 2003 - 我要上太空',
            '7.53 - 2008 - 红',
            '7.53 - 2010 - 意外的幸运签',
            '7.53 - 2005 - 灼眼的夏娜',
            '7.53 - 2015 - OVERLORD',
            '7.52 - 2013 - 黑塔利亚',
            '7.52 - 2006 - 兽爪',
            '7.52 - 2017 - 刀剑神域',
            '7.52 - 2011 - 幻想嘉年华',
            '7.52 - 2016 - 亚人',
            '7.52 - 2018 - 擅长捉弄的高木同学',
            '7.52 - 2003 - 茄子 安达鲁西亚之夏',
            '7.52 - 2010 - 天降之物',
            '7.52 - 2002 - 人形电脑天使心',
            '7.52 - 2005 - 极速方程式',
            '7.52 - 2007 - 校园乌托邦 学美向前冲',
            '7.52 - 2010 - 尸鬼',
            '7.51 - 2013 - 只有神知道的世界',
            '7.51 - 2006 - 驱魔少年',
            '7.51 - 2003 - 圣枪修女',
            '7.51 - 2011 - 未来日记',
            '7.51 - 2009 - 大正野球娘',
            '7.51 - 2006 - 惊爆草莓',
            '7.51 - 2004 - 库拉乌 幻之记忆',
            '7.51 - 2007 - 河童之夏',
            '7.50 - 2017 - 舞动青春',
            '7.50 - 2008 - 神薙',
            '7.49 - 2007 - 悲惨世界 少女柯塞特',
            '7.49 - 2012 - 心灵链环',
            '7.49 - 2002 - 战斗妖精雪风',
            '7.49 - 2008 - 道子与哈金',
            '7.49 - 1993 - 无责任舰长',
            '7.49 - 2017 - 路人女主的养成方法',
            '7.48 - 2003 - 魁!!库洛马迪高校',
            '7.48 - 1999 - THE BIG O',
            '7.48 - 2018 - 冲吧烈子',
            '7.48 - 2013 - 恋爱研究所',
            '7.48 - 2002 - 天使的小生意气',
            '7.48 - 2010 - 逆转监督',
            '7.48 - 2009 - 天堂餐馆',
            '7.48 - 2006 - FREEDOM',
            '7.47 - 2015 - 苍蓝钢铁的琶音',
            '7.47 - 2006 - 恶童',
            '7.47 - 1991 - 岁月的童话',
            '7.47 - 2011 - 恶魔阿萨谢尔在召唤你',
            '7.47 - 2018 - 恋如雨止',
            '7.47 - 2004 - 爱你宝贝',
            '7.47 - 1978 - 小英的故事',
            '7.47 - 2012 - 女子落语',
            '7.47 - 2009 - 玛利亚狂热',
            '7.47 - 1982 - 我青春的世外桃源',
            '7.46 - 2014 - 巴哈姆特之怒',
            '7.46 - 2004 - 爱丽丝学园',
            '7.46 - 2003 - 星际5555：异星梦系统秘传',
            '7.46 - 1979 - 红发少女安妮',
            '7.46 - 2012 - 圣诞之吻',
            '7.46 - 2005 - 我们的仙境',
            '7.46 - 2011 - 战国鬼才传',
            '7.46 - 2007 - 东京糖衣巧克力',
            '7.46 - 2010 - 我的妹妹哪有这么可爱',
            '7.45 - 1993 - 兽兵卫忍风帖',
            '7.45 - 1993 - 我是大哥大',
            '7.45 - 1989 - 以柔克刚',
            '7.45 - 2006 - 调酒师',
            '7.45 - 2012 - 境界线上的地平线',
            '7.45 - 1987 - 妙手小厨师',
            '7.45 - 2009 - 青之花',
            '7.44 - 2001 - 黑街二人组',
            '7.44 - 1983 - 格斗机器人柔王丸',
            '7.44 - 2012 - 嘟嘟猫观察日记',
            '7.44 - 2001 - 魔力女管家',
            '7.44 - 2013 - 精灵宝可梦',
            '7.44 - 2014 - Hybrid Child',
            '7.44 - 2017 - 鬼灯的冷彻',
            '7.44 - 1991 - OTAKU的录像带',
            '7.43 - 2017 - 亚人酱有话要说',
            '7.43 - 2014 - 信长协奏曲',
            '7.43 - 2005 - 枪心剑刃',
            '7.43 - 2013 - 某人的目光',
            '7.43 - 2011 - 宝石宠物',
            '7.43 - 1998 - 性感突击队 外传',
            '7.43 - 2011 - 女神异闻录',
            '7.43 - 1987 - 机器人嘉年华',
            '7.43 - 2006 - 家庭教师',
            '7.43 - 2005 - BLOOD',
            '7.43 - 2005 - 翡翠森林狼与羊',
            '7.43 - 1996 - BB有心事',
            '7.43 - 1981 - Daicon3开幕动画',
            '7.42 - 2009 - 夏之岚',
            '7.42 - 2001 - 大都会',
            '7.42 - 2015 - 花与爱丽丝杀人事件',
            '7.42 - 2009 - 青之文学',
            '7.42 - 1994 - 平成狸合战'
        ];

        $page = intval(Redis::GET('save-bangumi-score-page') ?: 0);
        $length = 50;
        $data = array_slice($source, $page, $length);
        if (empty($data))
        {
            return true;
        }
        $query = new Query();
        $bangumiSource = new BangumiSource();
        foreach ($data as $item)
        {
            $arr = explode(' - ', $item);
            $score = $arr[0];
            $year = $arr[1];
            $name = $arr[2];
            $list = $query->searchBangumi($name);
            if (empty($list))
            {
                Redis::SADD('save-bangumi-score-search-empty', $name);
                continue;
            }
            $matched = [];
            foreach ($list as $one)
            {
                if ($one['year'] === $year)
                {
                    $matched[] = $one;
                }
            }
            $matched = array_filter($matched, function ($item)
            {
               return $item['rank'];
            });
            if (count($matched) === 0)
            {
                Redis::SADD('save-bangumi-score-no-matched', $name);
                continue;
            }
            if (count($matched) > 1)
            {
                Redis::SADD('save-bangumi-score-many-matched', $name);
                continue;
            }
            $bangumi = Bangumi
                ::where('source_id', $matched[0]['id'])
                ->first();

            if (is_null($bangumi))
            {
                $fetch = $query->getBangumiDetail($matched[0]['id']);
                $bangumi = $bangumiSource->importBangumi($fetch);
            }

            if (is_null($bangumi))
            {
                Redis::SADD('save-bangumi-score-bangumi-null', $name);
                continue;
            }

            $bangumi->update([
                'score' => $score
            ]);
        }

        Redis::SET('save-bangumi-score-page', $page + $length);

        return true;
    }
}
